<div class="col-lg-6">
    <div class="card">
        <div class="card-body">
            <h5 class="card-title"><b>View unique link</b></h5>

            <p class="card-text">
                Please view your unique link from here if you had generated it the past 24 hours. If not,
                please regenerate it using the left box.
            <form class="form-inline ml-3" method="post" id="view-form">
                <div class="input-group input-group-sm">
                    {% csrf_token %}
                    <div class="row">
                        <div class="input-group input-group-sm">
                            <div class="col-lg-6">
                                <label for="email">Email Address</label>
                            </div>
                            <div class="col-lg-6">
                                <input class="form-control" type="email" id="email-view"
                                       name="email">
                            </div>
                        </div>
                        <div class="input-group input-group-sm">
                            <div class="col-lg-9"></div>
                            <div class="col-lg-3">
                                <button class="btn btn-link btn-dark" type="button" onclick="retrieve_js()">
                                    View
                                    <script>
                                        function retrieve_js() {
                                            let data = {};
                                            data.email = $("#email-view").val();
                                            $.ajax({
                                                url: "retrieve",
                                                type: "POST",
                                                data: JSON.stringify(data),
                                                contentType: "application/json",
                                                beforeSend: function (xhr, settings) {
                                                    xhr.setRequestHeader("X-CSRFToken", '{{ csrf_token }}');
                                                },
                                                dataType: 'json',
                                                success: function (result) {
                                                    if (result && Object.keys(result).length !== 0) {
                                                        $("div#link-view-div").removeAttr("hidden");
                                                        $("a#link-view").text(result["link"]);
                                                        $("a#link-view").attr("href", result["link"]);
                                                    } else {
                                                        $("div#link-view-div").attr("hidden", true);
                                                        $("a#link-view").text("");
                                                        $("a#link-view").attr("href", "");
                                                    }
                                                },
                                                complete: function () {
                                                    // $("#email-view").val("");
                                                }
                                            });
                                        }
                                    </script>
                                </button>
                            </div>
                        </div>
                        <div class="input-group input-group-sm">
                            <div class="col-lg-12" id="link-view-div" hidden>
                                    Your result will be available at this link: <a id="link-view"></a>. Please wait at
                                    least
                                    30 minutes to 1 hour for our email to arrive after you
                                    send us an email for the result to be available.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="input-group">

                </div>
            </form>
            </p>
        </div>
    </div>
</div>